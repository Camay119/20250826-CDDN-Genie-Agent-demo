# AI / BI Genie をエージェントシステムに組み込む3つの方法

## Databricks AI/BI Genie とは

### Databricks マネージドな Text-to-SQL 機能

**自然言語をSQLに変換** し、即座にデータ分析を実行することが可能

```
「昨日の天気は？」
    ↓
自動的にSQLクエリを生成・実行
    ↓
結果を返却
```

![](<99_images/genie.png>)

### Genieの強み

- **Unity Catalogとの統合** - セキュアなデータアクセス
- **メタデータの活用** - テーブル構造と業務知識を理解
- **継続的な学習** - ユーザーフィードバックで精度向上
### ちょっと触ってみよう
ちょっと触ってみます

### 「Genieをエージェントシステムに組み込む」とは
Genie の前にエージェントを噛ませて、ユーザーのクエリを振り分けてくれる仕組みを作りたい

![text](<99_images/genie_agent.png>)

### なぜGenieをエージェントに組み込む？
Genie スペースには 25テーブルしか突っ込めない（ベスプラでは5テーブル / スペース）ので、たくさんのテーブルにスケーリングするなら 複数のGenie を振り分けるエージェントが必要

---

## デモで使用するGenie Space

### 🍞 Bakehouse Sales Space
ベーカリーフランチャイズの販売データ分析
- 販売トランザクション
- 顧客情報
- フランチャイズ店舗データ

**サンプル質問**: 「売上トップ3のフランチャイズ店舗は？」

### 🌤️ Weather Metrics Space
世界主要都市の気象データ分析
- 気温、湿度、降水量
- 予測データと過去データ
- 50都市の情報

**サンプル質問**: 「東京の2024年7月の平均気温は？」

---

## 本日の流れ
0. **はじめに** （5分）
   - いまここ
1. **カスタムツール実装** （8分）
   - Unity Catalog Function を使う方法（Tool-Calling エージェント）

2. **Managed MCP実装** （2分）
   - Databricks Managed MCP Server を使う方法

3. **Genie Agent実装** （4分）
   - GenieAgent を使う方法（マルチエージェント）

4. **比較とまとめ** （1分）
   - 各アプローチのメリット・デメリット
   - 使い分けのポイント